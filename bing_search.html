<!DOCTYPE html>
<html>
<head>
    <title>Bing Search</title>
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
</head>
<body>
<section>
    <div id="results"></div>
</section>
<script>
    var rand = '';

    // Grab a random word from randomword.setgetgo.com
    var random_generator = function() {
        var random_url = 'http://randomword.setgetgo.com/get.php';

        $.ajax({
            type: 'GET',
            url: random_url,
            dataType: 'jsonp',
            jsonpCallback: 'rand'
        }).done(function(data) {
            rand = data.Word;
        });
    };

    // Executes a search on the Bing search engine a given number of times
    // delayed by a given number of seconds
    function bing_search(num, delay) {
        var base_search = 'https://www.bing.com/search?setmkt=en-US&q=',
            times_run = 0,
            url = '',
            open_window;

        var interval = setInterval(function() {
            random_generator();

            setTimeout(function() {
                url = base_search + rand;
                open_window = window.open(url, '_blank');
                times_run++;
                console.log('Number of results: ' + times_run + '. URL: ' + url);

                // Stop interval after a given time
                if (times_run === num) {
                    clearInterval(interval);
                }
            }, 1000);
        }, delay * 1000);
    }

    bing_search(20, 5);
</script>
</body>
</html>
